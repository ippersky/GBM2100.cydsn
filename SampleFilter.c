/* ========================================
 *
 * Copyright YOUR COMPANY, THE YEAR
 * All Rights Reserved
 * UNPUBLISHED, LICENSED SOFTWARE.
 *
 * CONFIDENTIAL AND PROPRIETARY INFORMATION
 * WHICH IS THE PROPERTY OF your company.
 *
 * ========================================
*/

#include "SampleFilter.h"

static float filter_taps[SAMPLEFILTER_TAP_NUM] = {
  0.005167875264909778,
  0.0004587885919734484,
  0.00047675707007576183,
  0.0004934940696387835,
  0.0005088978176070052,
  0.0005228764735605685,
  0.0005352932725424964,
  0.00054600713135319,
  0.0005549692183375462,
  0.0005620852786288227,
  0.0005672114689438845,
  0.0005703605823235922,
  0.0005713387873373182,
  0.0005701506276204242,
  0.0005666947559118164,
  0.0005609338201805773,
  0.0005528044418531416,
  0.000542292931406836,
  0.0005293539474224123,
  0.0005139918006317184,
  0.0004962114081152991,
  0.0004759834138117345,
  0.0004533430402853524,
  0.00042828621854699967,
  0.00040087778684947425,
  0.00037116410629237583,
  0.0003392510881072388,
  0.0003051587143080794,
  0.0002690121365379736,
  0.00023086698551017307,
  0.00019085112908594226,
  0.00014913463127770298,
  0.00010584481802363159,
  0.00006113638910183599,
  0.00001513622748884997,
  -0.00003194843251043148,
  -0.00008011007713726006,
  -0.00012874080688548631,
  -0.00017818555623278363,
  -0.00022783022699124778,
  -0.0002776259110013548,
  -0.00032748763773748663,
  -0.0003770390477260471,
  -0.0004260456940422178,
  -0.00047445431622788364,
  -0.0005219971237157013,
  -0.0005683588125641515,
  -0.0006136108327247692,
  -0.0006571255553543095,
  -0.0006990289056644375,
  -0.0007389956348046616,
  -0.0007768725904344094,
  -0.0008124222077192189,
  -0.0008454305158341684,
  -0.0008756696409572901,
  -0.0009029854456931624,
  -0.0009272168743008813,
  -0.000948163954158433,
  -0.0009657030089001488,
  -0.0009796293240463196,
  -0.0009898480349127404,
  -0.0009962529959661483,
  -0.0009988102844623694,
  -0.0009974632120149773,
  -0.0009922323957440406,
  -0.0009830951962146184,
  -0.000970087779505508,
  -0.0009532632590897541,
  -0.0009326427786768956,
  -0.0009082854154975903,
  -0.0008801989698801695,
  -0.0008484086960200071,
  -0.000812869064710234,
  -0.0007736601957498662,
  -0.000730672470797668,
  -0.0006841099600526495,
  -0.0006341237151694602,
  -0.0005811271818390096,
  -0.0005258166189085927,
  -0.0004689584038068494,
  -0.00041122981897568896,
  -0.0003525961895463935,
  -0.00029067620189276625,
  -0.00021619381717581095,
  -0.00015807916000016813,
  -0.00008998740301235773,
  -0.00002289702199557921,
  0.000044391464875385856,
  0.00011161096009905707,
  0.00017841236896734891,
  0.00024442644617181397,
  0.0003093642961347486,
  0.00037288960427177563,
  0.0004346329061850557,
  0.000494362134549196,
  0.0005516523901474142,
  0.0006062699055644849,
  0.0006578745436794223,
  0.0007061922083597718,
  0.0007509168417945691,
  0.0007917941301115256,
  0.0008285401660717681,
  0.0008609386026225554,
  0.0008887831093918239,
  0.0009118445103296928,
  0.0009299587038231928,
  0.000942920162297215,
  0.0009506003413763476,
  0.0009528676555457404,
  0.0009496761837767575,
  0.000940901472649693,
  0.0009265452539436885,
  0.0009065236775045856,
  0.0008808462698048515,
  0.0008495832215559424,
  0.0008127896175318573,
  0.0007705797846714695,
  0.0007230556464201025,
  0.0006704084569165096,
  0.000612594133018091,
  0.000550380876513309,
  0.00048323655013257877,
  0.00041208803292385637,
  0.0003369814025306694,
  0.00025803658955636733,
  0.00017578242678286142,
  0.00009064005512079129,
  0.000002829081830778348,
  -0.00008725251344383264,
  -0.00017914527248214293,
  -0.00027262762743880664,
  -0.0003668834290665181,
  -0.00046174061274888156,
  -0.0005566320787166992,
  -0.0006511567600732485,
  -0.0007448062738467175,
  -0.000837070890982681,
  -0.0009274081904307906,
  -0.001015354928469104,
  -0.0011004541659816126,
  -0.0011822323579753638,
  -0.0012602883837694305,
  -0.0013341262445518288,
  -0.001403338230534376,
  -0.001467484137238664,
  -0.001526185750505283,
  -0.0015790283851078754,
  -0.0016256692262330633,
  -0.0016657029837604633,
  -0.0016987884037937136,
  -0.001724611577193816,
  -0.0017428664648191626,
  -0.0017533498587234738,
  -0.0017558848744621326,
  -0.0017503947111876127,
  -0.001736790831641962,
  -0.0017151408377307873,
  -0.0016852290880840534,
  -0.001647080453170341,
  -0.00160044819424027,
  -0.0015452528739529,
  -0.0014817028205151564,
  -0.001410241852079863,
  -0.0013315707608955913,
  -0.0012461303216822295,
  -0.0011529888896326071,
  -0.0010498689435644534,
  -0.0009445919561978862,
  -0.0008305162713528109,
  -0.0007113750797090373,
  -0.0005868693412609623,
  -0.000457523684636125,
  -0.00032388836761560667,
  -0.00018656184400620332,
  -0.00004610035853292878,
  0.00009686386919690434,
  0.00024165219904012376,
  0.00038767593938671867,
  0.0005341479821318585,
  0.0006804409912235653,
  0.0008258097057244042,
  0.0009695619166987022,
  0.0011109528042595113,
  0.0012492683937971978,
  0.0013837424476484746,
  0.0015136688937002819,
  0.0016383440935958489,
  0.001757044492079163,
  0.0018691023576241758,
  0.0019737959882431223,
  0.0020704697853171695,
  0.0021584651316737843,
  0.002237224708535289,
  0.0023061242778540337,
  0.0023646917247182723,
  0.0024123570437689507,
  0.0024486599905893603,
  0.0024732071991201083,
  0.0024856124634158685,
  0.0024855825526940534,
  0.002472837111468637,
  0.002447198632923047,
  0.0024082134408775157,
  0.0023565215089863287,
  0.002290934987002713,
  0.0022125168087884176,
  0.00212095808910967,
  0.0020161139378430657,
  0.0018984189182403534,
  0.0017682781499383973,
  0.0016259040592806842,
  0.00147166153954427,
  0.0013060081658891132,
  0.0011293232891742733,
  0.0009425420406235739,
  0.0007461005340166383,
  0.000540798954474379,
  0.00032729334794706687,
  0.00010638098827735857,
  -0.00012108072133707664,
  -0.00035412556839571987,
  -0.0005917972690162595,
  -0.0008330890149583732,
  -0.001076943621337203,
  -0.0013223284820563569,
  -0.0015680712235175594,
  -0.0018130317189523947,
  -0.0020559894443698172,
  -0.002295755658379342,
  -0.0025310891089160275,
  -0.0027608200806729507,
  -0.00298370233983951,
  -0.00319853987855238,
  -0.0034041171500552437,
  -0.0035991673317146903,
  -0.0037824557397127608,
  -0.003952711588378372,
  -0.004108737222014029,
  -0.0042493492318596265,
  -0.004373608536354306,
  -0.00448034468740397,
  -0.004568732204741563,
  -0.0046375749893604054,
  -0.004685767016134245,
  -0.004712363146349216,
  -0.004716590505803153,
  -0.00469803573601741,
  -0.004656272299673868,
  -0.004589981465033232,
  -0.004497433556937027,
  -0.004381409533336805,
  -0.004238324393109188,
  -0.0040695609081576704,
  -0.003874384759188855,
  -0.0036526949776481787,
  -0.0034044464558478024,
  -0.003129705662733985,
  -0.0028285649701576066,
  -0.0025012534654865978,
  -0.00214810046698457,
  -0.0017694376337793049,
  -0.0013658560355608198,
  -0.0009378806905075721,
  -0.000486227302299136,
  -0.000011633327825532434,
  0.0004850302887587215,
  0.001002836413473926,
  0.001540709992159764,
  0.0020975494964050496,
  0.0026721705555876655,
  0.0032633001292003373,
  0.0038696430297650874,
  0.004489767100639234,
  0.005122214003646093,
  0.005765432506285532,
  0.006417893422159841,
  0.0070779233569498575,
  0.007743943107778471,
  0.00841418073123004,
  0.009086905576291984,
  0.009760365925547802,
  0.010432746651939275,
  0.011102272697541863,
  0.011767129957033525,
  0.012425545060076386,
  0.013075332905585765,
  0.013715760830662992,
  0.014343248522033966,
  0.014957794013387858,
  0.01555703146007758,
  0.016138840757685152,
  0.016701834346592503,
  0.017244633428394475,
  0.017765615600770022,
  0.018263205172118456,
  0.018735869715276424,
  0.0191820821425887,
  0.019600839054791472,
  0.019990776610185158,
  0.020350877803246032,
  0.02067999426155571,
  0.020977124208501282,
  0.02124135673125348,
  0.021471952439597194,
  0.021668237828471406,
  0.02182966112022086,
  0.021955765017144954,
  0.022046115814304993,
  0.02210046183183262,
  0.02211859043742586,
  0.02210046183183262,
  0.022046115814304993,
  0.021955765017144954,
  0.02182966112022086,
  0.021668237828471406,
  0.021471952439597194,
  0.02124135673125348,
  0.020977124208501282,
  0.02067999426155571,
  0.020350877803246032,
  0.019990776610185158,
  0.019600839054791472,
  0.0191820821425887,
  0.018735869715276424,
  0.018263205172118456,
  0.017765615600770022,
  0.017244633428394475,
  0.016701834346592503,
  0.016138840757685152,
  0.01555703146007758,
  0.014957794013387858,
  0.014343248522033966,
  0.013715760830662992,
  0.013075332905585765,
  0.012425545060076386,
  0.011767129957033525,
  0.011102272697541863,
  0.010432746651939275,
  0.009760365925547802,
  0.009086905576291984,
  0.00841418073123004,
  0.007743943107778471,
  0.0070779233569498575,
  0.006417893422159841,
  0.005765432506285532,
  0.005122214003646093,
  0.004489767100639234,
  0.0038696430297650874,
  0.0032633001292003373,
  0.0026721705555876655,
  0.0020975494964050496,
  0.001540709992159764,
  0.001002836413473926,
  0.0004850302887587215,
  -0.000011633327825532434,
  -0.000486227302299136,
  -0.0009378806905075721,
  -0.0013658560355608198,
  -0.0017694376337793049,
  -0.00214810046698457,
  -0.0025012534654865978,
  -0.0028285649701576066,
  -0.003129705662733985,
  -0.0034044464558478024,
  -0.0036526949776481787,
  -0.003874384759188855,
  -0.0040695609081576704,
  -0.004238324393109188,
  -0.004381409533336805,
  -0.004497433556937027,
  -0.004589981465033232,
  -0.004656272299673868,
  -0.00469803573601741,
  -0.004716590505803153,
  -0.004712363146349216,
  -0.004685767016134245,
  -0.0046375749893604054,
  -0.004568732204741563,
  -0.00448034468740397,
  -0.004373608536354306,
  -0.0042493492318596265,
  -0.004108737222014029,
  -0.003952711588378372,
  -0.0037824557397127608,
  -0.0035991673317146903,
  -0.0034041171500552437,
  -0.00319853987855238,
  -0.00298370233983951,
  -0.0027608200806729507,
  -0.0025310891089160275,
  -0.002295755658379342,
  -0.0020559894443698172,
  -0.0018130317189523947,
  -0.0015680712235175594,
  -0.0013223284820563569,
  -0.001076943621337203,
  -0.0008330890149583732,
  -0.0005917972690162595,
  -0.00035412556839571987,
  -0.00012108072133707664,
  0.00010638098827735857,
  0.00032729334794706687,
  0.000540798954474379,
  0.0007461005340166383,
  0.0009425420406235739,
  0.0011293232891742733,
  0.0013060081658891132,
  0.00147166153954427,
  0.0016259040592806842,
  0.0017682781499383973,
  0.0018984189182403534,
  0.0020161139378430657,
  0.00212095808910967,
  0.0022125168087884176,
  0.002290934987002713,
  0.0023565215089863287,
  0.0024082134408775157,
  0.002447198632923047,
  0.002472837111468637,
  0.0024855825526940534,
  0.0024856124634158685,
  0.0024732071991201083,
  0.0024486599905893603,
  0.0024123570437689507,
  0.0023646917247182723,
  0.0023061242778540337,
  0.002237224708535289,
  0.0021584651316737843,
  0.0020704697853171695,
  0.0019737959882431223,
  0.0018691023576241758,
  0.001757044492079163,
  0.0016383440935958489,
  0.0015136688937002819,
  0.0013837424476484746,
  0.0012492683937971978,
  0.0011109528042595113,
  0.0009695619166987022,
  0.0008258097057244042,
  0.0006804409912235653,
  0.0005341479821318585,
  0.00038767593938671867,
  0.00024165219904012376,
  0.00009686386919690434,
  -0.00004610035853292878,
  -0.00018656184400620332,
  -0.00032388836761560667,
  -0.000457523684636125,
  -0.0005868693412609623,
  -0.0007113750797090373,
  -0.0008305162713528109,
  -0.0009445919561978862,
  -0.0010498689435644534,
  -0.0011529888896326071,
  -0.0012461303216822295,
  -0.0013315707608955913,
  -0.001410241852079863,
  -0.0014817028205151564,
  -0.0015452528739529,
  -0.00160044819424027,
  -0.001647080453170341,
  -0.0016852290880840534,
  -0.0017151408377307873,
  -0.001736790831641962,
  -0.0017503947111876127,
  -0.0017558848744621326,
  -0.0017533498587234738,
  -0.0017428664648191626,
  -0.001724611577193816,
  -0.0016987884037937136,
  -0.0016657029837604633,
  -0.0016256692262330633,
  -0.0015790283851078754,
  -0.001526185750505283,
  -0.001467484137238664,
  -0.001403338230534376,
  -0.0013341262445518288,
  -0.0012602883837694305,
  -0.0011822323579753638,
  -0.0011004541659816126,
  -0.001015354928469104,
  -0.0009274081904307906,
  -0.000837070890982681,
  -0.0007448062738467175,
  -0.0006511567600732485,
  -0.0005566320787166992,
  -0.00046174061274888156,
  -0.0003668834290665181,
  -0.00027262762743880664,
  -0.00017914527248214293,
  -0.00008725251344383264,
  0.000002829081830778348,
  0.00009064005512079129,
  0.00017578242678286142,
  0.00025803658955636733,
  0.0003369814025306694,
  0.00041208803292385637,
  0.00048323655013257877,
  0.000550380876513309,
  0.000612594133018091,
  0.0006704084569165096,
  0.0007230556464201025,
  0.0007705797846714695,
  0.0008127896175318573,
  0.0008495832215559424,
  0.0008808462698048515,
  0.0009065236775045856,
  0.0009265452539436885,
  0.000940901472649693,
  0.0009496761837767575,
  0.0009528676555457404,
  0.0009506003413763476,
  0.000942920162297215,
  0.0009299587038231928,
  0.0009118445103296928,
  0.0008887831093918239,
  0.0008609386026225554,
  0.0008285401660717681,
  0.0007917941301115256,
  0.0007509168417945691,
  0.0007061922083597718,
  0.0006578745436794223,
  0.0006062699055644849,
  0.0005516523901474142,
  0.000494362134549196,
  0.0004346329061850557,
  0.00037288960427177563,
  0.0003093642961347486,
  0.00024442644617181397,
  0.00017841236896734891,
  0.00011161096009905707,
  0.000044391464875385856,
  -0.00002289702199557921,
  -0.00008998740301235773,
  -0.00015807916000016813,
  -0.00021619381717581095,
  -0.00029067620189276625,
  -0.0003525961895463935,
  -0.00041122981897568896,
  -0.0004689584038068494,
  -0.0005258166189085927,
  -0.0005811271818390096,
  -0.0006341237151694602,
  -0.0006841099600526495,
  -0.000730672470797668,
  -0.0007736601957498662,
  -0.000812869064710234,
  -0.0008484086960200071,
  -0.0008801989698801695,
  -0.0009082854154975903,
  -0.0009326427786768956,
  -0.0009532632590897541,
  -0.000970087779505508,
  -0.0009830951962146184,
  -0.0009922323957440406,
  -0.0009974632120149773,
  -0.0009988102844623694,
  -0.0009962529959661483,
  -0.0009898480349127404,
  -0.0009796293240463196,
  -0.0009657030089001488,
  -0.000948163954158433,
  -0.0009272168743008813,
  -0.0009029854456931624,
  -0.0008756696409572901,
  -0.0008454305158341684,
  -0.0008124222077192189,
  -0.0007768725904344094,
  -0.0007389956348046616,
  -0.0006990289056644375,
  -0.0006571255553543095,
  -0.0006136108327247692,
  -0.0005683588125641515,
  -0.0005219971237157013,
  -0.00047445431622788364,
  -0.0004260456940422178,
  -0.0003770390477260471,
  -0.00032748763773748663,
  -0.0002776259110013548,
  -0.00022783022699124778,
  -0.00017818555623278363,
  -0.00012874080688548631,
  -0.00008011007713726006,
  -0.00003194843251043148,
  0.00001513622748884997,
  0.00006113638910183599,
  0.00010584481802363159,
  0.00014913463127770298,
  0.00019085112908594226,
  0.00023086698551017307,
  0.0002690121365379736,
  0.0003051587143080794,
  0.0003392510881072388,
  0.00037116410629237583,
  0.00040087778684947425,
  0.00042828621854699967,
  0.0004533430402853524,
  0.0004759834138117345,
  0.0004962114081152991,
  0.0005139918006317184,
  0.0005293539474224123,
  0.000542292931406836,
  0.0005528044418531416,
  0.0005609338201805773,
  0.0005666947559118164,
  0.0005701506276204242,
  0.0005713387873373182,
  0.0005703605823235922,
  0.0005672114689438845,
  0.0005620852786288227,
  0.0005549692183375462,
  0.00054600713135319,
  0.0005352932725424964,
  0.0005228764735605685,
  0.0005088978176070052,
  0.0004934940696387835,
  0.00047675707007576183,
  0.0004587885919734484,
  0.005167875264909778
};

void SampleFilter_init(SampleFilter* f) {
  int i;
  for(i = 0; i < SAMPLEFILTER_TAP_NUM; ++i)
    f->history[i] = 0;
  f->last_index = 0;
}

void SampleFilter_put(SampleFilter* f, float input) {
  f->history[f->last_index++] = input;
  if(f->last_index == SAMPLEFILTER_TAP_NUM)
    f->last_index = 0;
}

float SampleFilter_get(SampleFilter* f) {
  float acc = 0;
  int index = f->last_index, i;
  for(i = 0; i < SAMPLEFILTER_TAP_NUM; ++i) {
    index = index != 0 ? index-1 : SAMPLEFILTER_TAP_NUM-1;
    acc += f->history[index] * filter_taps[i];
  };
  return acc;
}


/* [] END OF FILE */
